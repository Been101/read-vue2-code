{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/global-api/index.js","../src/compiler/parser.js","../src/compiler/generate.js","../src/compiler/index.js","../src/observe/array.js","../src/observe/dep.js","../src/observe/index.js","../src/state.js","../src/observe/scheduler.js","../src/observe/watcher.js","../src/vdom/patch.js","../src/lifecycle.js","../src/init.js","../src/vdom/index.js","../src/render.js","../src/index.js"],"sourcesContent":["export function isFunction(fn) {\n  return typeof fn === 'function'\n}\n\nexport function isObject(val) {\n  return typeof val === 'object' && val !== null\n}\n\nexport const isArray = Array.isArray \n\n\nlet callbacks = []\nlet waiting = false;\nfunction flushCallbacks() {\n  callbacks.forEach(fn => fn());\n  callbacks = [];\n  waiting = false\n}\n\nexport function nextTick(fn) {\n  callbacks.push(fn)\n  if(!waiting) {\n    Promise.resolve().then(flushCallbacks)\n    waiting = true\n  }\n}\n// 每使用依次 this.$nextTick 就会new 一个 promise\n// export function nextTick(fn) { // vue3 里面的 nextTick 就是 promise， vue3 里面做了一些兼容性处理\n//   return Promise.resolve().then(fn)\n// }\n\n// 覆盖合并 {a: 1} {b:1, a: 2} => {a: 2, b: 1}\n// 组合合并 {a: 1} {b:1， a:2} => {b: a, a: [1,2]}\n\nlet strats = {}; // 存放所有策略\n\nconst lifeCycle = ['beforeCreate', 'created', 'beforeMount', 'mounted'];\n\nlifeCycle.forEach(hook => {\n  strats[hook] = function(parentVal, childVal) {\n    if(childVal) {\n      if(parentVal) { // 父 子 都有值 用父和子拼接在一起， 父有值就一定是数组\n        return parentVal.concat(childVal)\n      } else {\n        if(Array.isArray(childVal)) {\n          return childVal\n        }else {\n          return [childVal] // 如果没有值， 就会变成数组\n        }\n      }\n    } else {\n      return parentVal\n    }\n  }\n})\n\nexport function mergeOptions(parentVal, childVal) {\n  const options = {}\n  for (const key in parentVal) {\n    mergeFiled(key)\n  }\n  for (const key in childVal) {\n    if (childVal.hasOwnProperty(key)) {\n      mergeFiled(key)\n    }\n  }\n\n  function mergeFiled(key) {\n    // 设计模式  策略模式\n    let strat = strats[key];\n    if(strat) {\n      options[key] = strat(parentVal[key], childVal[key]); // 合并两个值\n    } else {\n      options[key] = childVal[key] || parentVal[key]\n\n    }\n  }\n\n  return options;\n}\n\n// 看两个节点是不是相同节点，就看是不是 tag 和 key 都一样\n// Vue2 递归比对\nexport function isSameVnode(newVnode, oldVnode) {\n  return (newVnode.tag === oldVnode.tag) && (newVnode.key === oldVnode.key)\n}","import { mergeOptions } from \"../utils\";\n\nexport function initGlobalAPI(Vue) {\n  Vue.options = {}; // 全局属性，在每个组件初始化的时候， 将这些属性放到每个组件上\n  Vue.mixin = function(options) {\n    Vue.options = mergeOptions(this.options, options)\n    console.log(Vue.options, '<---options');\n  }\n  Vue.component = function(options) {}\n  Vue.filter = function(options) {}\n  Vue.directive = function(options) {}\n}","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;  // 匹配标签名的 aa-xxx\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; // aa:aa-xxx\n\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 此正则可以匹配到标签名  匹配到结果的第一个（索引第一个）[1]\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`)\n\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\n\nconsole.log(`aaa=xxx`.match(attribute)); // [1] 属性的key  [3] ||  [4] || [5] 属性的值\n\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的  />  >\n\n\n// vue3 的编译原理比 vue2 里好很多， 没有这么多正则了\n\n\n\n\nexport function parserHTML(html) {\n  console.log(html)\n  // 可以不停的截取模板，知道把模板全部解析完毕\n\n  // 我要构建父子关系\n  const stack = [];\n  let root = null;\n\n  function createASTElement(tag, attrs, parent) {\n    return {\n      tag,\n      parent,\n      attrs,\n      type: 1,\n      children: []\n    }\n  }\n  function start(tag, attrs) {  // [div, p]\n    // 遇到开始标签， 就取栈中的最后一个作为父节点\n    let parent = stack[stack.length - 1];\n    const element = createASTElement(tag, attrs, parent)\n    if(root === null) { // 说明当前节点就是根节点\n      root = element\n    }\n  \n    if(parent) {\n      element.parent = parent; // 更新 p 的parent属性指向 parent\n      parent.children.push(element)\n    }\n  \n    stack.push(element)\n    console.log(tag, attrs, '---start');\n  }\n  \n  function end(tagName) {\n    const endTag = stack.pop()\n    if(endTag.tag !== tagName) {\n      console.log('标签出错');\n    }\n  \n    console.log(tagName, '---end');\n  }\n  function text(chars) {\n    const parent = stack[stack.length - 1];\n    chars = chars.replace(/\\s/g, '')\n    if(chars) {\n      parent.children.push({\n        type: 2,\n        text: chars\n      })\n    }\n    console.log(chars, '---chars');\n  }\n\n  function advance(len) { // 把匹配到的元素删除掉\n    html = html.substring(len)\n  }\n  function parseStartTag() {\n    const start = html.match(startTagOpen);\n    if(start) {\n      const match = {\n        tagName: start[1],\n        attrs: []\n      }\n  \n      advance(start[0].length)\n  \n      let end, attr;\n      \n      while(!(end = html.match(startTagClose)) && (attr =  html.match(attribute))) { // 1. 要有属性 2.不能为开始的结束标签\n        match.attrs.push({name: attr[1], value: attr[3] || attr[4] || attr[5]})\n        advance(attr[0].length)\n      }\n      if(end) {\n        advance(end[0].length)\n      }\n      console.log(match, '-----match');\n      return match\n    }\n    return false\n  }\n\n  while (html) {\n    // 解析标签和文本\n    let index = html.indexOf('<');\n    if(index === 0) {\n      // 解析开始标签， 并且把属性也解析出来\n      const startTagMatch = parseStartTag();\n      if(startTagMatch) { // 开始标签\n        start(startTagMatch.tagName, startTagMatch.attrs)\n        continue\n      }\n      let endTagMatch;\n      if(endTagMatch = html.match(endTag)) { // 结束标签\n        end(endTagMatch[1]);\n        advance(endTagMatch[0].length)\n        continue;\n      }\n    }\n\n    if(index > 0) { // 文本\n      let chars = html.substring(0, index) // </div>\n      text(chars);\n      advance(chars.length)\n      console.log('内容是文本');\n    }\n  }\n\n  console.log(root, '---ast');\n  return root\n}\n","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g;  // {{ xxx }}\n\n\nfunction genProps(attrs) {\n  // {key:val, key: val}\n  let str = ''\n  for(let i = 0; i< attrs.length; i++) {\n    let attr = attrs[i];\n    if(attr.name === 'style') { // {name: id, value: 'app'}\n      const styles = {}\n      attr.value.replace(/([^;:]+):([^;:]+)/g, function() {\n        styles[arguments[1]] = arguments[2]\n      })\n      attr.value = styles\n    }\n    str += `${attr.name}: ${JSON.stringify(attr.value)},`\n  }\n  return `{${str.slice(0, -1)}}`\n}\n\nfunction gen(el) {\n  if(el.type === 1) {\n    return generate(el);\n  }else {\n    const text = el.text; // {{}}\n    if(!defaultTagRE.test(text)) return `_v('${text}')`  // 说明就是普通文本\n\n    // 说明有表达式，需要做一个表达式和普通值得拼接 ['message', _s(name), 'bbb'].join('+')\n    // _v('aaa' + _s(name) + 'bb')\n    let lastIndex = defaultTagRE.lastIndex = 0\n    const tokens = []\n    let match;\n    while (match = defaultTagRE.exec(text)) { // 如果正则 + g, 配合 exec 就会有个问题 lastIndex 的问题\n      let index = match.index;\n      if (index > lastIndex) {\n        tokens.push(JSON.stringify(text.slice(lastIndex, index)))\n      }\n      tokens.push(`_s(${match[1].trim()})`)\n      lastIndex = index + match[0].length\n      \n    }\n    // <div> aaa</div>\n    if(lastIndex < text.length) {\n      tokens.push(JSON.stringify(text.slice(lastIndex)))\n    }\n\n    return `_v(${tokens.join('+')})`\n  }\n}\n\nfunction genChildren(el) {\n  const children = el.children\n  if(children) {\n    return children.map(item => gen(item)).join(',')\n  }\n  return false\n}\n\n\nexport function generate(ast) {\n  const children = genChildren(ast);\n\n  const code = `_c('${ast.tag}', ${\n    ast.attrs.length ? genProps(ast.attrs) : 'undefined'\n  },${\n    children ? children : ''\n  })`\n\n  return code\n}","import { parserHTML } from './parser';\nimport { generate } from './generate';\n\nexport function compileToFunction(template) {\n\n  // 1. 将模板变成 ast 语法树\n  let ast = parserHTML(template)\n  console.log(ast);\n  // 代码优化， 标记静态节点\n\n  // 2. 代码生成\n  const code = generate(ast)\n  console.log(code, '-generate-code');\n  const render = new Function(`with(this){return ${code}}`)\n  console.log(render.toString());\n  return render;\n  \n  /**\n   * 1. 编译原理\n   * 2. 响应式原理 以来手机\n   * 3. 组件化开发  （贯穿了 vue 的流程）\n   * 4. diff 算法\n   */\n}","let oldArrayPrototype = Array.prototype // 获取数组的老的原型方法\n\nexport const arrayMethods = Object.create(oldArrayPrototype) // 让 arrayMethods 通过 __proto__ 能获取到数组的方法\n\nconst methods = ['push', 'pop', 'splice', 'shift','unshift', 'reverse', 'sort'] // 只有这七个方法可以导致数组发生变化\n\nmethods.forEach(method => {\n  arrayMethods[method] = function(...args) {\n    console.log('数组方法进行重写操作')\n\n    // 数组新增的属性 要看一下是不是对象， 如果是对象， 继续进行劫持\n    // 需要调用数组原生逻辑\n    // arr.push(1) // this 就是 arr\n    oldArrayPrototype[method].call(this, ...args)\n\n    // TODO 可以添加自己逻辑。 这种方式叫函数劫持 或 切片\n\n    let inserted = null\n    const ob = this.__ob__\n    switch (method) {\n      case 'splice':   // 修改 删除 添加  arr.splice(0, 0, 100, 200, 300)\n        inserted = args.slice(2); // splice 方法从第三个参数起是增添的新数据\n        break;\n      case 'push':\n      case 'unshift':\n        inserted = args; // 调用 push 和 unshift 传递的参数就是新增的逻辑\n        break;\n    }\n\n    // inserted 看一下它是否需要进行劫持\n    if(inserted) {\n      ob.observeArray(inserted)\n    }\n    ob.dep.notify()\n  }\n})","let id = 0;\n\nclass Dep {\n  constructor() { // 要把 watcher 放到 dep 中\n    this.subs = [];\n    this.id = id++;\n  }\n\n  depend() {\n    // 要给 watcher 也加一个标识， 防止重复\n    // this.subs.push(Dep.target) // 让 dep 记住这个 watcher, watcher 还要记住 dep  相互关系\n\n    Dep.target.addDep(this); // 在 watcher 中调用 dep 的 addSub 方法\n  }\n\n  addSub(watcher) {\n    this.subs.push(watcher) // 让 dep 记住这个 watcher\n  }\n\n  notify() {\n    this.subs.forEach(watcher => watcher.update())\n  }\n}\n\nDep.target = null; // 这里我用一个全局的变量， 静态属性\n\nexport default Dep;","import { isArray, isObject } from \"../utils\";\nimport { arrayMethods } from \"./array\";\nimport Dep from \"./dep\";\n\nclass Observer {\n  constructor(value) {\n\n  // 数组 如何依赖收集， 而且数组更新的时候如何触发更新?\n    // 如果给一个对象增添一个不存在的属性，我希望也能更新视图 [].__ob__.dep {}.__ob__.dep  => watcher  // vm.$set\n    this.dep = new Dep(); //  value 是对象和数组   value.__ob__.dep\n    // 添加一个自定义属性绑定this, 方便在 array.js 中使用观察数组方法且不让 __ob__ 被遍历到， 否则就走对象劫持的逻辑了， 就会出现死循环\n    Object.defineProperty(value, '__ob__', {\n      value: this,\n      enumerable: false // 标识这个属性不能被列举出来， 不能被循环到\n    })\n\n    if(isArray(value)) {\n      // 更改数组原型方法\n      value.__proto__ = arrayMethods // 重写数组的方法\n      // 如果数组里还有数组，要继续递归重写数组的原型链\n      this.observeArray(value);\n    }else {\n      this.walk(value) // 核心就是循环对象\n\n    }\n  }\n\n  observeArray(data) { // 递归遍历数组， 对数组内部的对象再次重写 [[], []]; [{}]\n    // vm.arr[0].a = 100\n    // vm.arrp[0] = 100\n     data.forEach(item => observe(item)) // 数组里面如果式引用类型那么是响应式的\n\n  }\n\n  walk(data) {\n    Object.keys(data).forEach(key => { // 要使用 defineProperty 重新定义\n      defineReactive(data, key, data[key]);\n    })\n  }\n}\n// vue2 应用了 defineProperty 需要一加载的时候就进行递归操作，所以耗性能，如果层次过深也会浪费性能\n\n// 1. 性能优化的原则\n// a. 不要把所有数据都放在 data 中，因为所有的数据都会增加 get 和 set\n// b. 不要写数据的时候层次过深，尽量扁平化数据\n// c. 不要频繁获取数据\n// d. 如果数据不需要响应式，可以使用 Object.freeze 冻结属性\n\n// 数组也可以使用 defineProperty 但是我们很少去采用 arr[333] = 2\n// 如果数组也使用了 defineProperty 还是可以实现修改索引触发更新的，但是这种操作概率低， 所以源码中没有采用这种方式， 所有 vue 中 数组修改索引不会导致视图更新，修改 length 也不会更新\n\n// vue3中为了兼容 proxy 内部对数组用的就是 defineProperty\n// 正常用户修改数组，无非采用数组的变异方法， push, pop, splice, shift. unshift. reverse, sort\n\nfunction dependArray(value) { // [[[]], {}]  // 让数组里的引用类型都收集依赖\n  for (let i = 0; i < value.length; i++) {\n    const current = value[i];\n    current.__ob__ && current.__ob__.dep.depend();\n    if(Array.isArray(current)) {\n      dependArray(current)\n    }\n  }\n}\nfunction defineReactive(obj, key, value) { // vue2 慢的原因主要在这个方法中\n  const childOb = observe(value) // 递归进行观测数据，不管有多少层，我都进行 defineProperty\n\n  let dep = new Dep()\n  Object.defineProperty(obj, key, {\n    get() {\n      if(Dep.target) {\n        dep.depend()\n        if(childOb) { // 取属性的时候会对对应的值（对象和数组）惊醒依赖收集\n          childOb.dep.depend();\n          if(Array.isArray(value)) {\n            dependArray(value)\n          }\n        }\n      }\n      \n      return value; // 闭包，此 value 会向上层的 value 进行查找\n    },\n    set(newValue) { // 如果设置的是一个对象那么会再次进行劫持\n      if(newValue === value) return;\n      /**\n       *  vm.message= {a: 100} // 会更新\n       * vm.message.a = 200 // 要想这种情况也更新， 需要对新赋的值也要观察\n       * vm.message.b = 12 // vue2 无法劫持到不存在的属性，新增不存在的属性 不会更新视图\n       * vm.arr[0].name = 'ming'\n       */\n\n      console.log(`修改了${key}`);\n      observe(newValue); // \n      value = newValue\n      dep.notify()\n    }\n  })\n}\n\nexport function observe(value) {\n\n  // 1. 如果 value 不是对象，那么就不用观测了， 说明写的有问题\n  if(!isObject(value)) {\n    return\n  }\n\n  if(value.__ob__) { // 一个对象不需要重复被观测\n    return;\n  }\n\n  // 需要对对象进行观测（最外层必须是一个{} 不能是数组）\n\n  // 如果一个数据已经被观测过了，就不要再进行观测了，用类来实现，我观测过就增加一个标识说明观测过了，在观测的时候可以检测是否观测过，如果观测过了就跳过检测\n\n  return new Observer(value)\n}\n\n/**\n * 1. 默认 vue 在初始化的时候会对对象每一个属性都进行劫持，增加 dep 属性， 当取值的时候会做依赖收集\n * 2. 默认还会对属性值是对象和数组的本身进行增加 dep 属性 进行依赖收集\n * 3. 如果是属性变化触发属性对应的 dep 去更新\n * 4. 如果是数组更新，触发数组的本身的 dep 进行更新\n * 5. 如果取值的时候是数组还要让数组中的对象类型也进行依赖收集（递归依赖收集）\n * 6. 如果数组里面方对象，默认对象里的属性是会进行依赖收集的，因为在取值时会进行 JSON.stringify 操作\n */","import { observe } from \"./observe/index\";\nimport { isFunction } from \"./utils\";\n\nexport function initState (vm) {\n  const opts = vm.$options;\n\n  if(opts.data) {\n    initData(vm)\n  }\n}\n\nfunction proxy(vm, key, source) { // 取值的时候做代理，不是暴力的把 _data 属性赋给 vm, 而且直接赋值会有命名冲突的问题\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[source][key]\n    },\n    set(newValue) {\n      vm[source][key] = newValue\n    }\n  })\n}\n\n\nfunction initData(vm) {\n  let data = vm.$options.data //\n\n  // 如果用户传递的是一个函数，则取函数的返回值作为对象，如果激素hi对象那就直接使用这个对象\n  // 只有根实例 data 可以是一个对象\n\n  // 希望 用户能够 直接 vm.message 进行取值，所以使用了一个 proxy 进行代理 vm._data\n  // data 和 vm._data 引用的是同一个  data 被劫持了  vm._data 也被劫持\n  data = vm._data =  isFunction(data) ? data.call(vm) : data\n\n  // 需要将 data 变成响应式的 Object.defineProperty\n  console.log('初始化数据')\n  observe(data)\n\n\n  for (const key in data) { // vm.message => vm._data.message\n    proxy(vm, key, '_data')  // 引用类型\n  }\n}","import { nextTick } from \"../utils\";\n\nlet queue = [] // 存放要更新的 watcher\nlet has = {} // 存放已有的 watcher 的 id\n\nlet pending = false\n\nfunction flushSchedulerQueue() {\n  queue.forEach(watcher => watcher.run());\n  queue = [] \n  has = {}\n  pending = false\n}\n\nexport function queueWatcher(watcher) {\n  let id = watcher.id\n  if(!has[id]) {\n    has[id] = true;\n    queue.push(watcher);\n    if(!pending) {\n      nextTick(flushSchedulerQueue)\n      pending = true\n    }\n  }\n}","import Dep from \"./dep\";\nimport { queueWatcher } from \"./scheduler\";\nlet id = 0;\nclass Watcher {\n  constructor(vm, fn, cb, options) {  // 要把 dep 放到  watcher 中\n    this.vm = vm;\n    this.fn = fn;\n    this.cb = cb;\n    this.options = options\n    this.id = id++  // 要给 watcher 也加一个标识， 防止重复\n    this.depsId = new Set();this.deps = []\n\n\n    this.getter = fn // fn 就是页面渲染的逻辑\n    this.get(); // 表示上来后就做一此初始化\n  }\n\n  get() {\n    Dep.target = this; // Dep.target = watcher\n    this.getter(); // 页面渲染的逻辑\n    Dep.target = null // 渲染完毕后， 就将标识清空了， 只有在渲染的时候才会进行依赖收集\n  }\n\n  addDep(dep) {\n    let did = dep.id;\n    if(!this.depsId.has(did)) { // 去重， 只有第一次的 watcher 才被收集到 deps 中\n      this.depsId.add(did);\n      this.deps.push(dep); // 做了保存 id 的功能， 并且让 watcher 记住 dep\n\n      dep.addSub(this)\n    }\n  }\n// 不论是对象还是数组的更新都会走这个 update 函数\n  update() { //  每次更新数据都会同步调用这个 update 方法， 我可以将更新的逻辑缓存起来， 等会同步更新数据的逻辑执行完毕后，依次调用（有去重的逻辑）\n\n    console.log('update')\n    // 可以做异步更新 // vue.nextTick [fn1, fn2, fn3] 相同的更新的话，只调用最后一个更新\n    // this.get();  \n    console.log('缓存更新的地方');\n    queueWatcher(this)\n  }\n\n  run() {\n    console.log('真正更新的地方');\n    this.get() // 延后执行更新逻辑\n  }\n\n}\n\nexport default Watcher;","import { isSameVnode } from \"../utils\";\n\nexport function patch(oldVnode, vnode) {\n  const isRealElement = oldVnode.nodeType // 如果是真实节点 nodeType 有值是 1\n  if(isRealElement) {\n    // 删除老节点， 根据 vnode 创建新节点， 替换掉老节点\n    const elm = createElm(vnode) // 根据虚拟节点创造了真实节点\n    const parentNode = oldVnode.parentNode;\n    parentNode.insertBefore(elm, oldVnode.nextSibling); // el.nextSibling 不存在就是 null, 如果为 null, insertBefore 就相当于 appendChild \n\n    parentNode.removeChild(oldVnode)\n    return elm; // 返回最新节点\n  }else {\n    console.log(oldVnode, 'patch-oldVnode');\n    console.log(vnode, 'patch-vnode');\n    // diff 算法如何实现?\n    // 只比较同级，如果不一样，子元素就不用对比了，根据当前节点，创建子元素，全部替换掉\n    if(!isSameVnode(oldVnode, vnode)) { // 如果新旧节点不是同一个， 删除老的换成新的\n      return oldVnode.el.parentNode.replaceChild(createElm(vnode), oldVnode.el)\n    }\n    // 下面是 相同节点的情况\n    const el = vnode.el = oldVnode.el; // 复用节点\n\n     // 文本直接更新即可，因为文本没有儿子\n    if (!oldVnode.tag) { // 没有标签，表明是文本\n      if(oldVnode.text !== vnode.text) {\n        return el.textContent = vnode.text\n      }\n    }\n\n    // 元素，新的虚拟节点\n    updateProperties(vnode, oldVnode.data)\n\n\n  }\n  \n}\n\n\n// 面试有问  虚拟节点的实现 -> 如何将虚拟节点渲染成真实节点\n\nfunction createElm(vnode) {\n  const { tag, data, children, text, vm} = vnode\n\n  // 我们让虚拟节点和真实节点做一个映射关系， 后续某个虚拟节点更新了 我可以跟踪到真实节点， 并且更新真实节点\n\n  if(typeof tag === 'string') {\n    vnode.el = document.createElement(tag);\n    // 如果有 data 属性， 我们需要把data 设置到元素上\n    updateProperties(vnode) // 重构一下更新属性的逻辑\n    children.forEach(child => {\n      vnode.el.appendChild(createElm(child))\n    })\n  }else {\n    vnode.el = document.createTextNode(text)\n  }\n  console.log(vnode, '---vnode');\n  return vnode.el\n}\n\n\nfunction updateProperties(vnode, oldProps = {}) {\n  // 初次渲染直接用 oldProps 给 vnode 的 el 赋值即可\n\n\n  // 更新逻辑，拿到老的 props 和 vnode 里面的 data 进行比对\n  const el = vnode.el; // dom真实的节点\n  const newProps = vnode.data || {}\n\n  const newStyle = newProps.style || {}\n  const oldStyle = oldProps.style || {}\n\n  for (const key in oldStyle) { // 老的样式有， 新的没有， 就把页面上的样式删除掉\n    if(!newStyle[key]) {\n      el.style[key] = ''\n    }\n  }\n\n  // 新旧比对，两个对象如果比对差异?\n  for (const key in newProps) {\n    if( key === 'style') {\n      for (const key in newStyle) {  // {style: {color: red}}\n           el.style[key] = newStyle[key];\n      }\n    }else {\n      el.setAttribute(key, newProps[key])\n\n    }\n  }\n  for (const key in oldProps) {\n    el.removeAttribute(key, oldProps[key])\n}\n  \n}","import Watcher from \"./observe/watcher\";\nimport { patch } from \"./vdom/patch\";\n\nexport function mountComponent(vm) {\n\n  // vue 初始化 dom 节点\n  const updateComponent = () => {\n    vm._update(vm._render())\n  }\n\n  callHook(vm, 'beforeCreate')\n  // 每个组件都有一个 watcher, 我们把这个 watcher 称之为 渲染 watcher \n  new Watcher(vm, updateComponent, () => {\n    console.log('后续增加更新钩子函数 update');\n    callHook(vm, 'created')\n  }, true)\n  callHook(vm, 'mounted')\n}\n\nexport function lifeCycleMixin(Vue) {\n  Vue.prototype._update = function (vnode) {\n    // 采用的是先序深度遍历  创建节点 （遇到节点就创建节点， 递归创建）\n\n    const vm = this;\n\n    // 第一次渲染是根据虚拟节点生成真实节点， 替换掉原来的节点\n\n    // 如果是第二次 生成一个新的虚拟节点和老的虚拟节点进行对比\n\n    vm.$el = patch(vm.$el, vnode)\n  }\n}\n\nexport function callHook(vm, hook) {\n  const handlers = vm.$options[hook];\n  if(handlers) {\n    handlers.forEach(hook => {\n      hook.call(vm); // 声明周期的 this 永远指向实例\n    });\n  }\n}","import { compileToFunction } from \"./compiler/index\";\nimport { initState } from \"./state\";\nimport { mountComponent } from './lifecycle'\nimport { mergeOptions, nextTick } from \"./utils\";\nexport function initMixin(Vue) {\n  // 后续组件开发的时候 Vue.extend 可以创造一个子组件，子组件可以继承 Vue, 子组件也可以调用 _init 方法\n  Vue.prototype._init = function(options) {\n    const vm = this;\n\n    // 把用户的选项放到 vm 上， 这样在其他方法中都可以获取到 options 了\n    // vm.$options = options; // 为了后续扩展的方法都可以获取 $options 选项\n    vm.$options = mergeOptions(vm.constructor.options, options) // vm.constructor 是 Vue 或 继承自Vue 的子类\n\n    // $options 中是用户传入的数据 el, data, watch ...\n    initState(vm)\n\n    if(vm.$options.el) {\n      // 将数据挂载到页面\n      console.log('页面要挂载');\n      // 现在数据已经被劫持了，数据 变化需要更新视图 diff 算法更新需要更新的部分\n      // vue -> template （写起来更符合直觉） -> jsx （灵活）\n      // vue3 template 写起来性能会更高一些， 内部做了很多优化\n\n      /**\n       * template -> ast 语法树（用来描述语法的， 描述语法本身的） -> 描述成一个树结构 -> 将代码重组成 js 语法\n       * \n       * 模板编译原理（把 template 模板编译成 render 函数 -> 虚拟DOM -> diff 算法比对虚拟DOM）\n       * \n       * ast -> render 返回 -> vnode -> 生成真实 dom\n       *       更新的时候再次调用 render -> 新的 vnode -> 新旧比对 -> 更新真实 dom\n       */\n      vm.$mount(vm.$options.el)\n    }\n\n  }\n\n  Vue.prototype.$mount= function(el) {\n    const vm = this;\n    const opts = vm.$options\n    el = document.querySelector(el) // 获取真实的元素\n    vm.$el= el // 页面真实元素\n\n    if(!opts.render) {\n      // 模板编译\n      let template = opts.template\n      if(!template) {\n        template = el.outerHTML\n      }\n      const render = compileToFunction(template)\n      opts.render = render;\n    }\n\n    // 这里已经获取到了， 一个 render 函数的了，这个函数的返回值 _c('div', {id: 'app'}, _c('span', undefined, 'hello'))\n    mountComponent(vm)\n\n  }\n\n  Vue.prototype.$nextTick = nextTick\n}","export function createElement(vm, tag, data = {}, ...children) { // 返回虚拟节点 _c('', {}, ...)\n  return vnode(vm, tag, data, children, data.key, undefined)\n}\n\nexport function createText(vm, text) {\n  return vnode(vm, undefined, undefined, undefined, undefined, text)\n}\n\nfunction vnode(vm, tag, data, children, key, text) {\n  return {vm, tag, data, children, key, text}\n}\n\n// vonode 其实就是一个对象， 用来描述节点的， 这个和 ast 长得很像啊\n// ast 描述语法的， 他并没有用户自己的逻辑， 只有雨打解析出来的内容\n// vnode 他是描述 dom 结构的， 可以自己取扩展属性","import { isObject } from \"./utils\";\nimport { createElement, createText } from \"./vdom\";\n\nexport function renderMixin(Vue) {\n  Vue.prototype._c = function () { // createElement 创建元素型的节点\n    console.log(arguments);\n    const vm = this;\n    return createElement(vm, ...arguments)\n  }\n  Vue.prototype._v = function (text) {\n    console.log(arguments);\n    const vm = this;\n    return createText(vm, text); // 描述虚拟节点是属于那个实例的\n  }\n  Vue.prototype._s = function (val) { // JSON.stringify()\n    console.log(arguments);\n\n    if (isObject(val)) {\n      return JSON.stringify(val)\n    }\n    return val\n  }\n  Vue.prototype._render = function () {\n    const vm = this;\n    const { render } = vm.$options;\n    const vnode = render.call(vm)\n    console.log(vnode, '--vnode');\n    return vnode\n  }\n}","import { initGlobalAPI } from \"./global-api\";\nimport { initMixin } from \"./init\";\nimport { lifeCycleMixin } from \"./lifecycle\";\nimport { renderMixin } from \"./render\";\n\n// vue 要如何实现， 原型模式， 所有的功能都通过原型扩展的方式来添加\nfunction Vue(options) {\n  this._init(options) // 实现 vue 的初始化功能\n}\n\ninitMixin(Vue)\nrenderMixin(Vue)\nlifeCycleMixin(Vue)\n\ninitGlobalAPI(Vue)\n\n// 导出 Vue 给别人用\nexport default Vue;\n\n\n/**\n * 1. new Vue 会调用 _init 方法进行初始化操作\n * 2. 会将用户的选项放到 vm.$options 上\n * 3. 会对当前属性上搜索有没有 data 数据  initState\n * 4. 有 data 判断 data 是不是一个函数， 如果是函数取返回值 initData\n * 5. observe 去观测 data 中的数据 和 vm 没关系， 说明 data 已经变成了响应式\n * 6. vm 上想取值也能取到 data 中的数据  vm._data = data 这样用户能取到 data 了， vm._data\n * 7. 用户觉得有点麻烦 vm.xxx => vm._data\n * 8.如果更新对象不存在的属性， 会导致视图不更新，如果是数组更新索引和长度不会触发更新\n * 9.如果是替换成一个新对象，新对象会被劫持， 如果是数组存放新内容 push unshift splice 新增的内容也会被劫持， 通过 __ob__ 进行标识这个对象被监控过 (在 vue中被监控的对象身上都有一个 __ob__ 这个属性)\n */"],"names":["isFunction","fn","isObject","val","isArray","Array","callbacks","waiting","flushCallbacks","forEach","nextTick","push","Promise","resolve","then","strats","lifeCycle","hook","parentVal","childVal","concat","mergeOptions","options","key","mergeFiled","hasOwnProperty","strat","isSameVnode","newVnode","oldVnode","tag","initGlobalAPI","Vue","mixin","console","log","component","filter","directive","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","match","startTagClose","parserHTML","html","stack","root","createASTElement","attrs","parent","type","children","start","length","element","end","tagName","pop","text","chars","replace","advance","len","substring","parseStartTag","attr","name","value","index","indexOf","startTagMatch","endTagMatch","defaultTagRE","genProps","str","i","styles","arguments","JSON","stringify","slice","gen","el","generate","test","lastIndex","tokens","exec","trim","join","genChildren","map","item","ast","code","compileToFunction","template","render","Function","toString","oldArrayPrototype","prototype","arrayMethods","Object","create","methods","method","args","call","inserted","ob","__ob__","observeArray","dep","notify","id","Dep","constructor","subs","depend","target","addDep","addSub","watcher","update","Observer","defineProperty","enumerable","__proto__","walk","data","observe","keys","defineReactive","dependArray","current","obj","childOb","get","set","newValue","initState","vm","opts","$options","initData","proxy","source","_data","queue","has","pending","flushSchedulerQueue","run","queueWatcher","Watcher","cb","depsId","Set","deps","getter","did","add","patch","vnode","isRealElement","nodeType","elm","createElm","parentNode","insertBefore","nextSibling","removeChild","replaceChild","textContent","updateProperties","document","createElement","child","appendChild","createTextNode","oldProps","newProps","newStyle","style","oldStyle","setAttribute","removeAttribute","mountComponent","updateComponent","_update","_render","callHook","lifeCycleMixin","$el","handlers","initMixin","_init","$mount","querySelector","outerHTML","$nextTick","undefined","createText","renderMixin","_c","_v","_s"],"mappings":"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"}